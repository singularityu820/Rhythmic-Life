# 📝 软件功能与结构设计文档 - 本地智能时间管理AI助手

## 1\. 📌 项目概述

  * **项目名称：** 律动生活 (Rhythmic Life) - 本地智能时间管理AI助手
  * **开发目标：** 打造一款用户友好、功能强大的本地时间管理工具。它能帮助用户高效记录日常活动，深入分析时间分配规律，并通过**内置的AI算法**，为用户生成个性化、低阻力的日程规划。最终目标是引导用户建立健康、高效的作息习惯，持续提升生活质量和个人产出。
  * **核心功能：** 全面支持活动记录与分类、多维度数据统计与可视化、基于本地数据训练的AI智能规划、用户行为习惯分析、以及本地数据备份与恢复。
  * **用户群体：** 广泛的个人用户，包括学生、职场人士、自由职业者等，特别是那些注重数据隐私、希望在本地设备上管理时间和提升效率的用户。
  * **平台环境：**
      * **桌面端：** Electron (使用 **React.js** 构建用户界面)
      * **移动端：** **React Native** (iOS, Android - 确保跨平台一致的用户体验)
      * **AI计算：** **应用本地内置的 Python 解释器或使用 TensorFlow.js 进行推理**，确保所有数据处理和AI算法运行都在用户设备上完成。

-----

## 2\. 🔧 功能需求说明（Functional Requirements）

### 2.1 功能编号：F001 - 时间段活动记录

  * **功能名称：** 活动时间轴记录
  * **功能描述：** 用户可以便捷地记录一天中的各项活动。支持手动输入活动的开始时间、结束时间、详细内容描述，并能为活动选择预设或自定义的类型标签。此外，用户可以对每项活动的完成效率进行主观评分（1-5分）。
  * **前置条件：** 无。
  * **输入数据：**
      * `start_time` (datetime): 活动开始的具体日期和时间。
      * `end_time` (datetime): 活动结束的具体日期和时间。
      * `description` (string, max 255 chars): 对活动内容的简要描述，例如“撰写项目报告”、“学习Python编程”。
      * `activity_type_id` (int): 关联的活动类型ID，从F002（自定义活动类型管理）中选择。
      * `efficiency_score` (int, 1-5): 用户对该活动效率的主观评价，1代表效率极低，5代表效率极高（可选）。
  * **输出数据 / 行为：**
      * **行为A：** 活动记录成功保存至本地存储，并实时更新时间轴视图。
      * **行为B：** 记录的时长和类型数据被系统收集，为后续统计和AI分析提供基础。
  * **异常流程：**
      * **时间冲突：** 如果新记录的时间段与已有记录重叠，系统应提示用户并提供编辑或覆盖选项。
      * **时间倒置：** `start_time` 晚于 `end_time` 时，系统应提示错误并要求重新输入。
      * **输入为空：** 关键字段（如开始/结束时间、活动类型）为空时，提示用户补全。
  * **业务规则：**
      * 单个活动记录不允许跨越自然日。
      * 时间精度可精确到分钟。
      * 支持“进行中”模式：用户可以启动计时器开始一项活动，并在结束时自动记录时长。

### 2.2 功能编号：F002 - 自定义活动类型管理

  * **功能名称：** 活动标签自定义
  * **功能描述：** 用户可以灵活创建、编辑和删除自己的活动类型（或称“标签”），例如“专注工作”、“休闲娱乐”、“健身运动”等。每个类型可以配置一个颜色和图标，以便在时间轴和报表中直观区分。
  * **前置条件：** 无。
  * **输入数据：**
      * `type_name` (string, max 50 chars): 新活动类型的名称，例如“深度学习”。
      * `color_code` (string): 标签在界面上显示的颜色，例如“\#4CAF50” (可选)。
      * `icon_name` (string): 关联的图标名称或Unicode编码（例如，基于Material Icons库的名称），用于视觉识别 (可选)。
  * **输出数据 / 行为：**
      * **行为A：** 活动类型创建/更新/删除成功，并实时更新可用标签列表。
  * **异常流程：**
      * **名称重复：** 新建或编辑时，活动类型名称与现有类型重复，提示用户修改。
      * **删除关联类型：** 如果尝试删除的类型已被现有活动记录引用，系统应提示用户是否将这些记录迁移到其他类型或一并删除。
  * **业务规则：**
      * 系统提供一组默认活动类型（如“工作”、“休息”、“学习”），用户可选择使用或隐藏。
      * 每个活动类型名称必须唯一。

### 2.3 功能编号：F003 - 多维度时间统计与报表

  * **功能名称：** 周期性时间分析报告
  * **功能描述：** 根据用户本地存储的活动记录数据，生成详细的每日、每周、每月时间使用报告。报告以可视化图表（如饼图、柱状图、折线图）形式展示不同类型活动的投入时长、占比，以及效率评分的平均趋势。
  * **前置条件：** 用户已至少记录少量活动数据。
  * **输入数据：**
      * `start_date` (date): 报表查询的起始日期。
      * `end_date` (date): 报表查询的结束日期。
      * `period_type` (string): 查询周期类型，可选择“daily”（日）、“weekly”（周）、“monthly”（月）。
  * **输出数据 / 行为：**
      * **行为A：** 页面显示指定周期内各项活动的总时长、百分比，以及效率评分的汇总数据。
      * **行为B：** 生成并展示图表，如：
          * **饼图：** 展示当前周期内不同活动类型的时间占比。
          * **柱状图：** 展示每日/每周/每月各类型活动的总时长。
          * **折线图：** 展示效率评分随时间（日/周）的变化趋势。
  * **异常流程：**
      * **日期范围无效：** 结束日期早于开始日期，提示用户修正。
      * **无数据：** 所选周期内无任何活动记录，提示用户“暂无数据”。
  * **业务规则：**
      * 所有统计计算均在本地完成，不依赖外部服务器。
      * 支持自定义报表周期（例如，选择任意日期范围）。

### 2.4 功能编号：F004 - AI智能日程规划

  * **功能名称：** 个性化日程推荐
  * **功能描述：** 基于用户本地的历史活动数据（包括活动时长、类型、效率评分、完成习惯等），内置的AI算法会智能分析用户的精力周期、效率高峰和低谷，从而为第二天生成一份“阻力最小”的个性化日程建议。用户可以查看AI生成的规划，并进行必要的微调。
  * **前置条件：** 用户至少有7天的有效活动记录数据，以便AI进行初步分析。
  * **输入数据：**
      * `planning_date` (date): 需要生成规划的日期（通常是当前日期的后一天）。
      * `user_goals` (list of objects): 用户当日希望完成的主要任务列表。每个任务对象包含：
          * `task_name` (string): 任务名称。
          * `priority` (string): 优先级（`high`, `medium`, `low`）。
          * `estimated_duration` (int): 预估完成该任务所需时长（分钟）。
      * `current_energy_level` (int, 1-5): 用户当前精力水平的主观评价（可选，用于影响规划）。
  * **输出数据 / 行为：**
      * **行为A：** 返回一个包含建议时间段、活动类型、建议时长和任务描述的日程规划列表。
      * **行为B：** 页面以时间轴或列表形式直观展示AI生成的日程表。
      * **行为C：** 用户可以拖拽、修改或删除日程表中的项，系统应能自动调整受影响的后续时间段（如，如果用户将“会议”提前，AI会调整后续的“工作”时间）。
  * **异常流程：**
      * **数据不足：** 如果本地历史数据不足，AI可能无法生成有效规划，提示用户需要更多数据。
      * **规划冲突：** 用户手动调整导致时间段重叠，系统应提示冲突。
  * **业务规则：**
      * AI规划将优先考虑用户设定的高优先级任务。
      * AI会尝试在用户历史高效率时段安排需要高注意力的活动，在低效率时段安排休息或轻度任务。
      * 确保每日规划中包含充足的休息、用餐时间。
      * 用户对规划的修改和最终执行情况，会作为反馈数据，**在本地**用于持续优化AI模型。

### 2.5 功能编号：F005 - 用户习惯分析与建议

  * **功能名称：** 行为模式洞察与优化建议
  * **功能描述：** 基于用户长期（例如30天以上）的本地时间记录和效率数据，系统内置分析模块将深度挖掘用户的行为模式。例如，识别用户在特定时间段的效率高峰和低谷、各类活动的平均耗时、是否存在长期拖延某种任务的倾向等。系统将生成个性化的分析报告，并给出可操作性的时间管理优化建议。
  * **前置条件：** 用户有足够多的本地历史数据（建议至少30天连续记录）。
  * **输入数据：**
      * `user_activity_data` (json array): 用户的全部本地历史活动记录。
  * **输出数据 / 行为：**
      * **行为A：** 返回一个包含多维度分析结果的报告，例如：
          * **效率曲线：** 每日/每周的平均效率趋势图。
          * **时间分配热力图：** 展示一天中哪些时段最常进行哪些活动。
          * **任务耗时分析：** 不同类型任务的平均完成时长。
          * **专注力时长分析：** 每次专注工作（如“工作”、“学习”类型）的平均持续时间。
      * **行为B：** 提供基于分析结果的个性化建议，例如：
          * “你通常在下午2-4点效率较低，建议安排午休或轻度任务。”
          * “近一周你的运动时长不足，建议在周末增加活动。”
          * “你的深度工作时长通常在上午9-11点，请确保该时段不受打扰。”
  * **异常流程：**
      * **数据不足：** 如果本地数据量太小，无法生成有意义的报告，系统将提示用户并引导其继续记录。
  * **业务规则：**
      * 分析和建议生成过程完全在本地进行，不涉及数据上传。
      * 建议应以鼓励和引导为主，而非强制性。

### 2.6 功能编号：F006 - 本地数据导出与导入

  * **功能名称：** 数据备份与迁移
  * **功能描述：** 用户可以方便地将所有本地存储的活动记录、自定义活动类型、AI规划历史等数据导出为可读的文件格式（如JSON或CSV），用于个人备份或在不同设备间手动迁移。同时，支持导入之前导出的数据文件，以恢复或合并数据。
  * **前置条件：** 无。
  * **输入数据：**
      * **导出：** 无额外输入，仅需用户选择文件保存路径和文件名。
      * **导入：** `data_file` (file): 用户选择的要导入的数据文件。
  * **输出数据 / 行为：**
      * **行为A：** 导出成功，将数据保存到指定路径的文件中。
      * **行为B：** 导入成功，本地数据被更新或合并。
  * **异常流程：**
      * **文件操作失败：** 权限不足、磁盘空间不足、文件损坏等。
      * **格式不匹配：** 导入的文件格式与系统预期不符，提示用户。
      * **数据冲突：** 导入数据与现有本地数据存在冲突（如ID重复），提供合并或覆盖选项。
  * **业务规则：**
      * 导出文件应包含所有必要的本地数据，确保完整性。
      * 导入功能应健壮，能处理部分数据损坏或不完整的情况。
      * 隐私提示：明确告知用户导出文件将包含其所有本地数据，并建议妥善保管。

-----

## 3\. 🧬 数据结构设计（Data Schema）

所有数据结构都将直接存储在本地，例如通过 `IndexedDB`（Web/Electron）或 `SQLite`（React Native），或者更简单的键值存储。

### 3.1 应用配置结构体 `AppConfig`

  * **存储位置：** 用于存储应用级别的用户设置，不包含敏感数据。
  * **描述：** 维护应用的基本配置和用户偏好。

<!-- end list -->

```json
{
  "id": "int", // 通常固定为 1，因为是单用户本地应用
  "username": "string", // 用户设置的昵称，可选，用于界面展示
  "created_at": "datetime", // 应用首次启动时间
  "last_active_at": "datetime", // 应用最后一次活跃时间
  "settings": { // 其他本地设置，可扩展
    "theme": "string", // 应用主题，如 "light", "dark"
    "notification_enabled": "boolean", // 是否启用应用内通知
    "daily_summary_time": "time" // 每日总结提醒时间
  }
}
```

| 字段                 | 类型         | 描述                               |
| :------------------- | :----------- | :--------------------------------- |
| `id`                 | `int`        | 应用配置唯一标识符，固定为1        |
| `username`           | `string`     | 用户设置的昵称                     |
| `created_at`         | `datetime`   | 应用首次启动时间                   |
| `last_active_at`     | `datetime`   | 应用最后一次活跃时间               |
| `settings`           | `json`       | 包含用户偏好和应用配置的JSON对象   |

### 3.2 活动类型结构体 `ActivityType`

  * **存储位置：** 本地存储，用户自定义标签。
  * **描述：** 定义用户活动的分类。

<!-- end list -->

```json
{
  "id": "int", // 活动类型唯一标识符，自增或UUID
  "type_name": "string", // 活动类型名称，如“工作”、“休息”
  "color_code": "string", // 在界面上显示的颜色（Hex Code），如 "#FF5733"
  "icon_name": "string", // 关联的图标名称或Unicode编码，如 "work_outline"
  "is_default": "boolean" // 是否为系统预设类型（用户不可删除）
}
```

| 字段         | 类型      | 描述                       |
| :----------- | :-------- | :------------------------- |
| `id`         | `int`     | 活动类型唯一标识符         |
| `type_name`  | `string`  | 活动类型名称，如“工作”     |
| `color_code` | `string`  | 类型展示颜色 (Hex Code)    |
| `icon_name`  | `string`  | 类型关联图标名称           |
| `is_default` | `boolean` | 是否为系统预设类型         |

### 3.3 活动记录结构体 `ActivityRecord`

  * **存储位置：** 本地存储，核心数据。
  * **描述：** 记录用户每天的具体活动。

<!-- end list -->

```json
{
  "id": "int", // 活动记录唯一标识符，自增或UUID
  "activity_type_id": "int", // 关联的活动类型ID (外键关联 ActivityType)
  "start_time": "datetime", // 活动开始时间，ISO 8601格式，例如 "2024-05-23T09:00:00Z"
  "end_time": "datetime", // 活动结束时间，ISO 8601格式
  "description": "string", // 活动内容描述，如“撰写项目报告”
  "efficiency_score": "int", // 用户对该活动的效率评分 (1-5)，可选
  "created_at": "datetime", // 记录创建时间
  "updated_at": "datetime" // 记录最后更新时间
}
```

| 字段             | 类型       | 描述                     |
| :--------------- | :--------- | :----------------------- |
| `id`             | `int`      | 活动记录唯一标识符       |
| `activity_type_id` | `int`      | 关联的活动类型ID         |
| `start_time`     | `datetime` | 活动开始时间             |
| `end_time`       | `datetime` | 活动结束时间             |
| `description`    | `string`   | 活动内容描述             |
| `efficiency_score` | `int`      | 用户对该活动的效率评分 (1-5) |
| `created_at`     | `datetime` | 记录创建时间             |
| `updated_at`     | `datetime` | 记录最后更新时间         |

### 3.4 AI规划任务结构体 `AIPrompt`

  * **存储位置：** 本地存储，用于记录AI规划的历史和用户反馈。
  * **描述：** 存储AI生成的日程规划，以及用户对该规划的反馈。

<!-- end list -->

```json
{
  "id": "int", // 规划记录唯一标识符，自增或UUID
  "plan_date": "date", // 规划的日期，例如 "2024-05-24"
  "user_goals": "json", // 用户设定的目标及其优先级、预估时长，例如 [{"task": "完成报告", "priority": "high", "duration": 180}]
  "generated_plan": "json", // AI生成的详细日程计划，结构如：[{start_time: "...", end_time: "...", activity_type_id: "...", description: "...", task_priority: "..."}]
  "user_feedback": "string", // 用户对AI规划的文本反馈（可选）
  "feedback_score": "int", // 用户对AI规划的满意度评分（1-5分，可选）
  "created_at": "datetime", // 记录创建时间
  "updated_at": "datetime" // 最后更新时间 (如用户微调规划或提供反馈后)
}
```

| 字段             | 类型       | 描述                     |
| :--------------- | :--------- | :----------------------- |
| `id`             | `int`      | 规划记录唯一标识符       |
| `plan_date`      | `date`     | 规划的日期               |
| `user_goals`     | `json`     | 用户当日目标，包括任务名称、优先级、预估时长 |
| `generated_plan` | `json`     | AI生成的详细日程计划列表 |
| `user_feedback`  | `string`   | 用户对AI规划的文本反馈   |
| `feedback_score` | `int`      | 用户对AI规划的满意度评分 (1-5) |
| `created_at`     | `datetime` | 记录创建时间             |
| `updated_at`     | `datetime` | 最后更新时间             |

-----

## 4\. 🏗️ 系统模块划分（System Module Design）

### 4.1 模块一：应用配置与本地数据管理 (App Config & Local Data Management)

  * **核心职责：** 负责应用的启动、配置管理、所有本地数据的持久化存储与检索。
  * **功能子项：**
      * **本地数据存储服务：** 提供统一的接口，供其他模块读写活动记录、活动类型、AI规划等数据。封装底层存储机制（如 IndexedDB/SQLite/AsyncStorage）。
      * **应用设置服务：** 管理用户在应用内的各种偏好设置（主题、通知时间等）。
      * **数据导入/导出服务：** 实现将所有本地数据打包为文件（如JSON/CSV）导出，以及从文件解析数据并导入到本地存储的功能。
  * **内部逻辑：**
      * 初始化本地数据库/存储机制。
      * 定义数据模型和数据迁移（如果需要）。
      * 提供原子性的数据操作（增、删、改、查）。
      * 处理数据导入时的数据合并/覆盖逻辑。

### 4.2 模块二：核心业务逻辑 (Core Business Logic)

  * **核心职责：** 处理时间管理的核心功能，包括活动的创建、修改、删除和查询。
  * **功能子项：**
      * **活动管理服务：** 接收用户输入的活动数据，校验其有效性，并调用本地数据存储服务进行保存。处理活动时间段的重叠、冲突等业务逻辑。
      * **活动类型管理服务：** 提供创建、编辑、删除自定义活动类型的功能，并维护类型列表。
      * **任务目标管理服务：** 管理用户设置的每日/每周任务目标及其优先级和预估时长。
  * **内部逻辑：**
      * 数据输入校验规则。
      * 活动时间段的排序和合并算法。
      * 维护活动类型与活动记录之间的关联。

### 4.3 模块三：可视化与分析模块 (Visualization & Analysis Module)

  * **核心职责：** 对用户的本地时间数据进行统计分析，并以直观的可视化图表展示，提供用户行为洞察。
  * **功能子项：**
      * **数据聚合服务：** 从本地数据存储服务获取原始活动记录，按日期、活动类型等维度进行分组、计数、求和等聚合操作。
      * **统计计算服务：** 计算各项统计指标，如总时长、平均效率、各类活动占比、每日效率曲线等。
      * **图表渲染服务：** 调用前端图表库（如 ECharts for React）根据计算结果生成饼图、柱状图、折线图、热力图等。
      * **习惯分析引擎：** 基于统计数据和预设规则，分析用户的作息规律、高效率时段、低效率时段、主要活动偏好等，生成个性化文字建议。
  * **内部逻辑：**
      * 复杂的日期和时间序列数据处理算法。
      * 统计学计算（平均值、方差、趋势分析）。
      * 数据与图表库的适配层。

### 4.4 模块四：AI助手模块 (AI Assistant Module)

  * **核心职责：** 利用本地存储的用户行为数据，训练或加载AI模型，为用户生成个性化的日程规划。
  * **功能子项：**
      * **数据特征化：** 将原始活动记录转化为AI模型可理解的特征向量（如时间戳、活动类型编码、效率分数等）。
      * **AI模型管理：** 加载预训练的AI模型，或在本地小批量训练模型（如果性能允许）。模型可能是基于规则、统计预测、或者轻量级机器学习模型（如决策树、简单的神经网络）。
      * **规划生成器：** 接收用户请求，结合用户历史数据、当前目标、精力状况等，通过AI模型生成一个建议的日程规划。
      * **反馈学习机制：** 收集用户对AI规划的修改和满意度反馈。这些反馈数据将被用于**增量训练**或**调整AI的内部参数**，以适应用户的特定习惯（完全在本地进行）。
  * **内部逻辑：**
      * Python AI逻辑：通过 **Pyodide** (WebAssembly) 将 Scikit-learn 或 Pandas 等库在浏览器/Electron中运行，或在桌面应用中，通过 **`electron-python-shell`** 等方式直接调用本地 Python 环境。
      * JavaScript AI逻辑：如果模型足够轻量，也可以使用 **TensorFlow.js** 在前端直接进行模型推理和少量训练。
      * 规划算法：可能结合优化算法（如贪心算法、启发式搜索）和机器学习预测。

### 4.5 模块五：用户界面 (User Interface)

  * **核心职责：** 提供直观、响应式的用户交互界面，展示数据和功能。
  * **功能子项：**
      * **时间轴视图：** 实时展示每日活动的时间轴，支持拖拽、编辑。
      * **活动记录表单：** 供用户输入活动详情的界面。
      * **报表展示页：** 展示统计图表和习惯分析报告。
      * **日程规划展示页：** 展示AI生成的日程表，并提供编辑功能。
      * **设置页：** 管理应用配置、活动类型、数据导入/导出等。
  * **内部逻辑：**
      * 组件化开发（React Components）。
      * 状态管理（如 React Context API, Redux, Zustand）。
      * 响应式布局设计，适配桌面和移动端。
      * 与上述核心模块的数据和服务进行交互，实现数据绑定和UI更新。

-----

## 5\. 🔌 接口设计（API Spec）

作为本地应用，这里没有传统的 HTTP/RESTful API 接口。而是定义了**模块间的数据流转与本地存储操作的规范**。这部分类似于内部服务接口。

### 5.1 本地数据存储服务接口 (`LocalStorageService`)

  * **方法：** `saveRecord(type: string, data: object)`
      * **描述：** 保存指定类型的数据对象到本地存储。
      * **参数：** `type` (string, e.g., 'activityRecords', 'activityTypes', 'aiPlans'), `data` (object)
      * **返回值：** Promise\<boolean\> (表示保存是否成功)
  * **方法：** `getRecords(type: string, filter?: object)`
      * **描述：** 从本地存储获取指定类型的数据，可带过滤条件。
      * **参数：** `type` (string), `filter` (object, 可选)
      * **返回值：** Promise\<Array\<object\>\>
  * **方法：** `updateRecord(type: string, id: any, updates: object)`
      * **描述：** 更新本地存储中指定ID的记录。
      * **参数：** `type` (string), `id` (any), `updates` (object)
      * **返回值：** Promise\<boolean\>
  * **方法：** `deleteRecord(type: string, id: any)`
      * **描述：** 删除本地存储中指定ID的记录。
      * **参数：** `type` (string), `id` (any)
      * **返回值：** Promise\<boolean\>
  * **方法：** `exportAllData()`
      * **描述：** 导出所有本地数据为JSON格式。
      * **返回值：** Promise\<string\> (JSON字符串)
  * **方法：** `importAllData(jsonData: string)`
      * **描述：** 导入JSON数据并更新本地存储。
      * **参数：** `jsonData` (string)
      * **返回值：** Promise\<boolean\>

### 5.2 AI助手服务接口 (`AIAssistantService`)

  * **方法：** `generatePlan(planDate: Date, goals?: Array<object>, energyLevel?: int)`
      * **描述：** 基于本地数据和用户输入生成日程规划。
      * **参数：** `planDate` (Date), `goals` (Array\<object\>, 可选), `energyLevel` (int, 可选)
      * **返回值：** Promise\<Array\<object\>\> (返回AI生成的日程项列表)
  * **方法：** `processFeedback(planId: int, feedback: string, score: int)`
      * **描述：** 接收用户对AI规划的反馈，并用于本地模型优化。
      * **参数：** `planId` (int), `feedback` (string), `score` (int)
      * **返回值：** Promise\<boolean\>
  * **方法：** `analyzeHabits()`
      * **描述：** 分析用户本地习惯数据，生成洞察报告。
      * **返回值：** Promise\<object\> (返回分析结果对象)

### 5.3 统计分析服务接口 (`StatsService`)

  * **方法：** `getDailySummary(date: Date)`
      * **描述：** 获取某一天的活动汇总数据。
      * **参数：** `date` (Date)
      * **返回值：** Promise\<object\> (返回日统计数据)
  * **方法：** `getPeriodSummary(startDate: Date, endDate: Date, periodType: string)`
      * **描述：** 获取指定周期（周/月）的活动汇总数据。
      * **参数：** `startDate` (Date), `endDate` (Date), `periodType` (string)
      * **返回值：** Promise\<object\> (返回周期统计数据)

-----

## 6\. 🗂 数据流程与页面结构（选填）

### 6.1 功能流程图示例：AI规划生成与用户微调 (本地)

```mermaid
graph TD
    A[用户点击“生成计划”按钮 (UI)] --> B{UI层调用 AIAssistantService.generatePlan()};
    B --> C[AIAssistantService 从 LocalStorageService 获取所有历史活动数据];
    C --> D[AIAssistantService 在本地对数据进行预处理];
    D --> E[AIAssistantService 在本地执行 AI 规划算法 (如 TensorFlow.js 模型推理)];
    E --> F[生成初步日程规划数据];
    F --> G[AIAssistantService 将规划数据返回给 UI 层];
    G --> H[UI 层展示 AI 生成的日程表];
    H --> I{用户查看并进行微调};
    I -- 用户接受或修改 --> J[UI 层将最终规划数据保存到 LocalStorageService];
    J --> K[UI 层将用户对规划的反馈发送给 AIAssistantService.processFeedback()];
    K --> L[AIAssistantService 使用反馈数据在本地优化 AI 模型];
    L --> M[AI 模型得到优化，用于未来规划];
```

### 6.2 页面流转图（简图）

  * **应用启动/主页 (今日计划页)：** 核心页面，展示当日时间轴、当前活动，提供快速记录入口。
  * **今日计划页** \<--\> **活动记录详情/编辑页：** 详细录入和修改单项活动的界面。
  * **今日计划页** -\> **统计报表页 (日/周/月视图)：** 切换不同周期，查看各项统计图表。
  * **统计报表页** -\> **习惯分析页：** 展示系统生成的行为模式洞察和优化建议。
  * **今日计划页** -\> **AI规划生成/编辑页：** 触发AI生成第二天规划，并提供手动调整功能。
  * **AI规划生成/编辑页** -\> **AI规划反馈页：** 允许用户评价AI规划的满意度。
  * **今日计划页** -\> **设置页：** 访问应用配置、活动类型管理、本地数据导出/导入等功能。
  * **设置页** -\> **活动类型管理页：** 管理自定义活动标签。
  * **设置页** -\> **本地数据导出/导入页：** 进行数据备份和恢复操作。

-----

## 7\. 🔮 可扩展性与版本计划

### 7.1 可扩展性

  * **数据模型：** 数据结构设计时预留未来扩展字段，如可添加任务附件、子任务、心情记录等。
  * **AI模型：** 模块化设计AI部分，方便未来替换更复杂的模型或引入新的AI功能（如语音识别记录）。
  * **UI组件：** 采用 React 组件化开发，便于复用和扩展新功能界面。
  * **本地存储：** 考虑使用支持索引和查询的本地数据库（如 IndexedDB 或 SQLite），方便数据量大时的高效检索。
  * **跨平台：** React Native 架构天然支持 iOS 和 Android，Electron 支持桌面端，未来可考虑将核心逻辑封装为可共享的库。

### 7.2 版本计划

| 版本号 | 功能范围                                                                                                         | 预计时间      |
| :----- | :--------------------------------------------------------------------------------------------------------------- | :------------ |
| **v1.0** | **核心MVP：** 活动时间轴记录、自定义活动类型、基础的每日/每周/每月统计与可视化、基于简单规则/统计的AI智能规划。所有数据和AI均在本地。 | 2025年Q4      |
| **v1.1** | **AI优化与洞察：** 优化AI规划算法（引入基础机器学习模型如线性回归、决策树），增加用户对AI规划的本地反馈机制，更详细的习惯分析与建议报告。 | 2026年Q1      |
| **v1.2** | **增强效率工具：** 任务优先级与时长预估功能、优化AI规划的用户体验（如拖拽调整）、引入番茄工作法计时器、本地数据导出/导入功能。 | 2026年Q2      |
| **v1.3** | **个性化与沉浸：** 进阶AI能力 (如基于用户自评的精力曲线感知与规划调整)、更精细的个性化建议、自定义主题、应用内通知。 | 2026年Q3      |

-----

## 8\. 📎 备注与技术栈建议

  * **前端 (桌面/Web):** **React.js**
      * **核心库：** React, React Router
      * **状态管理：** Recoil (简单高效) 或 Zustand (轻量灵活)
      * **UI 组件库：** Ant Design 或 Material-UI (提供丰富的预设组件，加快开发速度)
      * **图表库：** ECharts for React (功能强大，图表类型丰富) 或 Recharts (轻量级 React 图表库)
      * **本地存储：** IndexedDB (通过 `Dexie.js` 或类似库进行封装，提供类似数据库的操作体验)
  * **前端 (移动端):** **React Native**
      * **核心库：** React Native
      * **状态管理：** 同 React.js
      * **UI 组件库：** React Native Paper (Material Design 风格) 或 NativeBase
      * **图表库：** React Native Chart Kit
      * **本地存储：** `react-native-sqlite-storage` (SQLite 数据库) 或 `@react-native-async-storage/async-storage` (键值存储)
  * **桌面应用打包：** **Electron** (将 React Web 应用打包为跨平台桌面应用)
      * **AI集成（桌面端）：**
          * **方案一 (推荐)：** `electron-python-shell` 或类似的库，在 Electron 应用中调用本地安装的 Python 环境运行 AI 脚本（使用 **Flask** 作为轻量级内部 API 接口，只在本地进程间通信，不对外开放）。
          * **方案二：** 如果 AI 模型足够轻量，可以考虑将 Python 模型转换为 ONNX 格式，然后用 `onnxruntime-web` 或 `TensorFlow.js` 直接在 JavaScript 环境中运行推理。
  * **AI/数据科学库 (Python):**
      * **机器学习：** `scikit-learn` (用于行为模式识别、效率预测等)
      * **数据处理：** `pandas`, `numpy` (数据清洗、特征工程)
      * **轻量级 Flask 应用：** 用于在本地提供 AI 模型的服务接口 (仅供 Electron/React Native 调用，不对外联网)。
  * **日期时间处理：** `date-fns` (轻量且功能强大) 或 `moment.js` (功能全面但体积较大)。
  * **代码规范：** ESLint, Prettier。

-----